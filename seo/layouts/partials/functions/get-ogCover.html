{{- /*
	MODULE: SEO
	Function: get-ogCover
	@requires hugo-modules/colors
	---
	Creates a basic Open Graph cover for the given page.

	@TODO Allow custom base template/bg image
	@TODO Favicon overlay?
	@TODO Custom font
	@TODO Giving some error where $title is template.html
	---
	Params:
	- .	Page context
	---
	Returns
	- [string]	Path to the page's generated OG cover image
*/ -}}
{{- $cover := "" -}}

{{- /* Tries to create a solid background from your theme color. */ -}}
{{- $page := . -}}
{{- $bg := partialCached "functions/get-themeBg.html" . "default" -}}
{{- with $bg -}}
	{{- $textColor := "#ffffff" -}}
	{{- with site.Params.Seo.ThemeColor -}}
		{{- $textColor = partialCached "functions/get-wcagBW.html"
		(dict "Color" .) . -}}
	{{- end -}}
	{{- $title := $page.LinkTitle | plainify -}}
	{{- $cover = $bg.Filter (images.Text (string $title) (dict
		"color" $textColor
		"size" 60
		"linespacing" 2
		"x" (div $bg.Width 3)
		"y" (div $bg.Height 2.5)
	)) -}}

	{{- /* Rename the image */ -}}
	{{- $permalink := printf "assets/images/og/%s.jpg" ($page.LinkTitle | anchorize) -}}
	{{- $cover = resources.Copy $permalink $cover -}}
{{- end -}}
{{- return $cover -}}
